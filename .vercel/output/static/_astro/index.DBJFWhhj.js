import{a as x,T as k,I as C}from"./Toast.BZml51HT.js";import{A as I}from"./Anchor.fzLUPe0_.js";import{B as A}from"./Button.BgwQzOqK.js";import{s as _,u as h}from"./register.DGVlyAii.js";import{s as E,a as P}from"./client.Db7OmKgL.js";import"./index.esm.vxxS9n3R.js";import{l as N}from"./auth.CbDBHLPr.js";import{T as V}from"./runtime-dom.esm-bundler.CNGa7J2q.js";import{_ as b}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as n,b as l,d as t,w as a,r,o as d,a as B,F as y,g as m}from"./runtime-core.esm-bundler.Db96a2QS.js";/* empty css                       */import"./index.BSdFiPHn.js";const R={components:{Input:C,Anchor:I,Button:A,ToastContainer:k,Toast:x},data(){return{isLoading:!1,useRegister:h,activeInput:"email",email:"",password:"",dangerToast:{message:""}}},methods:{setActiveInput(s){this.activeInput=s},goToPassword(){if(this.email==null||this.email===""){this.dangerToast.message="Please Enter your email.";return}if(!this.email.includes("@")){this.dangerToast.message="Not an email format.";return}this.setActiveInput("password"),_(this.email),this.useRegister=h},async createAccount(){if(this.isLoading=!0,this.password==null||this.password===""){this.dangerToast.message="Please Enter a password.";return}try{const s=await fetch("/api/v1/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.email,password:this.password})}),e=await s.json();if(!s.ok)throw new Error(e.message||"Registration failed on server.");console.log("Client: User registered via API. Server response:",e)}catch(s){console.error(s)}try{const e=(await E(P,this.email,this.password)).user,p=await e.getIdToken(),c=await fetch("/api/v1/auth/session-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({idToken:p})});if(!c.ok){const o=await c.json();throw new Error(o.message||"Failed to create session on server.")}N({user:{id:e.uid,email:e.email,displayName:e.displayName||e.email.split("@")[0]},token:p}),window.location.href="/build-profile"}catch(s){console.error("Client: Registration/Login Error:",s),this.dangerToast.message=s.message||"An unexpected error occurred during registration."}this.isLoading=!1}}},S={class:"flex flex-col items-center relative pt-20 px-8 grow"};function j(s,e,p,c,o,u){const g=r("Input"),f=r("Button"),w=r("Anchor"),v=r("Toast"),T=r("ToastContainer");return d(),n("div",S,[e[7]||(e[7]=l("div",{class:"flex flex-col items-center gap-4"},[l("span",{class:"text-zinc-400 font-bold"},"Start your travels in"),l("img",{class:"w-48",src:"/images/logo-agdayo-lg.png",alt:""}),l("span",{class:"baybayin text-[.5rem] text-zinc-400"},"agdayoagdayoagdayoagdayoagdayoagdayoagdayoagdayoagdayo")],-1)),t(V,{name:"fade",mode:"out-in"},{default:a(()=>[(d(),n("div",{key:o.activeInput,class:"gap-4 sm:w-72 w-full pt-20 flex flex-col items-center justify-center"},[o.activeInput==="email"?(d(),n(y,{key:0},[t(g,{type:"email",class:"w-full",id:"email",label:"Please Enter your email",placeholder:"Email","prefix-icon":"ph ph-user",modelValue:o.email,"onUpdate:modelValue":e[0]||(e[0]=i=>o.email=i)},null,8,["modelValue"]),t(f,{onClick:u.goToPassword,class:"w-full"},{default:a(()=>e[3]||(e[3]=[m("Next")])),_:1},8,["onClick"])],64)):o.activeInput==="password"?(d(),n(y,{key:1},[t(g,{type:"password",class:"w-full",id:"password",label:"Please Enter your password",placeholder:"Password","prefix-icon":"ph ph-lock",modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=i=>o.password=i)},null,8,["modelValue"]),t(f,{onClick:u.createAccount,loading:o.isLoading,class:"w-full"},{default:a(()=>e[4]||(e[4]=[m("Create Account")])),_:1},8,["onClick","loading"]),t(w,{onClick:e[2]||(e[2]=i=>u.setActiveInput("email")),href:"javascript:void('')"},{default:a(()=>e[5]||(e[5]=[m("Go Back to email")])),_:1})],64)):B("",!0)]))]),_:1}),t(w,{class:"pt-8",href:"/login"},{default:a(()=>e[6]||(e[6]=[m("Go Back to login")])),_:1}),t(T,null,{default:a(()=>[t(v,{variant:"error",ref:"dangerToast",message:o.dangerToast.message},null,8,["message"])]),_:1})])}const M=b(R,[["render",j],["__scopeId","data-v-2f06221d"]]);export{M as default};
