---
import Layout from "@/shared/layouts/LayoutWSidebar.astro"
import Main from "@/shared/layouts/Main.vue"
import Topbar from "@/shared/components/UI/Topbar.vue"
import ActiveTrips from "@/trip-execution/pages/index.vue" // Note: This refers to index.vue
import Spinner from "@/shared/components/UI/Spinner.vue";
export const prerender = false

// Get the user data that the middleware attached to `Astro.locals`
// This is now the definitive source for user information.
const user = Astro.locals.user;

// Pass the user's photo URL to the Topbar component
const userPhotoURL = user?.photoURL || null;

---
<Layout>
  <Main>
    <Topbar title="Active Trips" photoURL={userPhotoURL} client:load />
    <ActiveTrips client:load/>
  </Main>
</Layout>
